# 影片轉場效果規格 - 待決策問題清單

**文件編號**：SPEC-TRANSITION-001-DECISIONS  
**建立日期**：2025-01-08  
**決策日期**：2025-01-08  
**狀態**：✅ Approved  
**相關規格**：video-transition-effects.md  
**決策負責人**：產品負責人 + 技術負責人

---

## 📋 決策摘要表

| # | 決策項目 | 優先度 | 影響範圍 | 決策結果 | 狀態 |
|---|---------|--------|----------|----------|------|
| D1 | 單一影片模式是否淡出 | 🔴 高 | 使用者體驗 | 選項 3 - 也淡出（一致性） | ✅ 已決策 |
| D2 | 第一個單字影片淡入行為 | 🟡 中 | 視覺一致性 | 選項 A2 - 不淡入 | ✅ 已決策 |
| D3 | 淡出曲線類型 | 🟡 中 | 視覺品質 | 線性曲線 | ✅ 已決策 |
| D4 | 音訊淡入功能需求 | 🟢 低 | 進階功能 | 實作（Phase 3 必要） | ✅ 已決策 |
| D5 | 自訂淡出/淡入時長 | 🟢 低 | 可配置性 | Phase 3 實作 | ✅ 已決策 |
| D6 | JSON 層級轉場設定 | 🟢 低 | 靈活性 | 暫不實作 | ✅ 已決策 |
| D7 | 向後相容策略 | 🔴 高 | 現有使用者 | 選項 1 - 直接升級 | ✅ 已決策 |
| D8 | 結尾影片淡出處理 | 🟡 中 | 完整流程 | 選項 1 - 不額外淡出 | ✅ 已決策 |
| D9 | 實作優先順序 | 🔴 高 | 開發時程 | 選項 2 - 完整 Phase 1-3 | ✅ 已決策 |

---

## 🔴 高優先度決策（必須決定）

### D1: 單一影片輸出模式的淡出行為

**問題描述**：  
當使用 `spellvid make` 製作單一影片（而非批次模式）時，影片結尾是否應該應用淡出效果？

**背景**：  
- 批次模式：淡出有助於單字間的過渡
- 單一影片：沒有後續影片，淡出可能不必要

**選項分析**：

#### 選項 1：單一影片不應用淡出（推薦）✅
**理由**：
- 單一影片沒有後續內容，淡出無實際功能價值
- 保持影片內容完整可見至最後一刻
- 避免使用者困惑（為何單獨輸出的影片會變黑）

**優點**：
- ✅ 使用者體驗更直觀
- ✅ 影片內容完整呈現
- ✅ 與「轉場」概念一致（只在有下一個影片時才需要）

**缺點**：
- ❌ 批次與單一模式行為不一致
- ❌ 單一影片看起來「突然結束」

**實作影響**：
- 需在 `render_video_stub()` 中檢查是否為批次模式
- 簡單的 if 判斷即可實作

#### 選項 2：提供 CLI 旗標讓使用者決定
**旗標設計**：
```powershell
# 預設不淡出，使用者可啟用
python -m spellvid.cli make ... --fade-out

# 批次模式預設淡出，使用者可停用
python -m spellvid.cli batch ... --no-fade-out
```

**優點**：
- ✅ 最大靈活性
- ✅ 使用者可根據需求選擇

**缺點**：
- ❌ 增加 CLI 複雜度
- ❌ 需要文件說明
- ❌ 多數使用者不會用到

**實作影響**：
- 需增加 CLI 參數
- 需更新 help 文件與使用範例

#### 選項 3：單一影片也淡出（一致性優先）
**理由**：
- 保持所有輸出影片行為一致
- 符合現有規格 FR-EXPORT-3（1 秒淡出）

**優點**：
- ✅ 實作簡單
- ✅ 所有影片行為一致

**缺點**：
- ❌ 單一影片淡出無意義
- ❌ 浪費 3 秒內容時間

**決策建議**：**選項 1** - 單一影片不應用淡出

**需確認事項**：
- [ ] 產品負責人認可選項 1 的理由
- [ ] 確認是否需要未來增加 `--fade-out` 旗標（選項 2）
- [ ] 確認文件如何說明此行為差異

**決策結果**：採用選項 3（單一影片也淡出）  
**確認人員**：Andy Hsu 
**理由**：單一影片也會有結尾影片, 不做淡出效果會結束的很突兀.
---

### D7: 向後相容策略（1 秒 vs 3 秒淡出）

**問題描述**：  
現有規格 FR-EXPORT-3 要求「影片末端加入 1 秒淡出」，新規格要求「最後 3 秒淡出」。如何處理已存在的使用者與內容？

**背景**：
- 已有使用者可能依賴 1 秒淡出的行為
- 改為 3 秒會改變輸出影片的視覺效果
- 可能已有人基於 1 秒淡出製作了內容

**選項分析**：

#### 選項 1：直接升級為 3 秒淡出（破壞性變更）⚠️
**理由**：
- 專案仍在快速迭代期，使用者基數小
- 3 秒淡出是更好的產品決策
- 統一規格，避免維護兩種模式

**優點**：
- ✅ 實作簡單，無需維護舊邏輯
- ✅ 所有使用者獲得改進的體驗
- ✅ 文件與程式碼清晰

**缺點**：
- ❌ 已製作的影片風格會改變
- ❌ 使用者需要重新渲染已有內容

**實作影響**：
- 直接修改淡出時長為 3.0
- 更新 FR-EXPORT-3 文件

**溝通策略**：
- 在 CHANGELOG 中明確標註 Breaking Change
- 提供 migration guide（重新渲染建議）

#### 選項 2：提供 CLI 參數向後相容
**設計**：
```powershell
# 使用新的 3 秒淡出（預設）
python -m spellvid.cli batch --json config.json

# 向後相容：使用 1 秒淡出（舊行為）
python -m spellvid.cli batch --json config.json --fade-out-duration 1.0

# 完全停用淡出
python -m spellvid.cli batch --json config.json --fade-out-duration 0
```

**優點**：
- ✅ 使用者可選擇
- ✅ 舊內容可重現
- ✅ 平滑過渡

**缺點**：
- ❌ 增加實作複雜度
- ❌ 需維護參數處理邏輯
- ❌ 文件需說明預設值變更

**實作影響**：
- Phase 3 功能提前實作
- 需增加 `--fade-out-duration` 參數

#### 選項 3：使用版本號區分行為
**設計**：
- SpellVid v1.x：1 秒淡出
- SpellVid v2.x：3 秒淡出（major version bump）

**優點**：
- ✅ 符合語意化版本規範
- ✅ 清楚標示破壞性變更

**缺點**：
- ❌ 需要版本管理機制
- ❌ 使用者需注意版本差異

**決策建議**：**選項 1** - 直接升級（如果使用者基數 < 10）或 **選項 2** - 提供參數（如果已有大量使用者）

**需確認事項**：
- [ ] 目前有多少使用者在使用 SpellVid？
- [ ] 是否已有人依賴 1 秒淡出的行為？
- [ ] 是否願意接受 Breaking Change？
- [ ] 是否需要 `--fade-out-duration` 參數作為長期功能？

**決策結果**：採用選項 1（直接升級）  
**確認人員**：Andy Hsu 
**理由**：原本的1秒淡出尚未實作, 可以忽略.
---

### D9: 實作優先順序與時程

**問題描述**：  
規格定義了 Phase 1-3 共三個階段，哪些功能必須在初版實作，哪些可以後續迭代？

**背景**：
- Phase 1: 核心轉場功能（2-3 天）
- Phase 2: 整合與測試（2 天）
- Phase 3: 進階功能（1-2 天，可選）

**選項分析**：

#### 選項 1：僅實作 Phase 1 + Phase 2（推薦）✅
**範圍**：
- ✅ 淡出效果（畫面 + 音訊，固定 3 秒）
- ✅ 淡入效果（畫面，固定 1 秒）
- ✅ 批次模式整合
- ✅ 基本測試（單元 + 整合 + E2E）
- ✅ 文件更新
- ❌ CLI 自訂時長參數（留待未來）
- ❌ JSON 層級設定（留待未來）
- ❌ 音訊淡入（留待未來）

**時程**：4-5 工作天

**理由**：
- 滿足核心需求（「前 3 秒淡出，聲音淡出；1 秒淡入，聲音直接恢復」）
- 可快速交付價值
- 避免過度設計

#### 選項 2：完整實作 Phase 1-3
**範圍**：
- 所有 Phase 1-2 功能
- ✅ CLI 自訂參數 `--fade-out-duration` / `--fade-in-duration`
- ✅ `--disable-transitions` 旗標
- ✅ JSON 層級轉場設定（可選）
- ✅ 音訊淡入功能 `--audio-fadein`

**時程**：6-8 工作天

**理由**：
- 提供最大靈活性
- 處理向後相容問題（D7 選項 2）
- 一次性完成所有功能

**缺點**：
- 時程較長
- 可能包含不常用的功能

#### 選項 3：Phase 1 → 驗證 → Phase 2 → 評估 Phase 3
**迭代方式**：
1. 實作 Phase 1（2-3 天）
2. 內部測試與使用者反饋（1 週）
3. 實作 Phase 2（2 天）
4. 根據反饋決定是否實作 Phase 3

**理由**：
- 敏捷開發，快速驗證
- 避免實作不需要的功能

**決策建議**：**選項 1** - Phase 1 + Phase 2（核心功能優先）

**需確認事項**：
- [ ] 專案時程是否允許 4-5 天開發？
- [ ] 是否需要自訂時長參數（D7 影響）？
- [ ] 初版交付後多久會進行下一次迭代？

**決策結果**：採用選項 2（完整實作 Phase 1-3）  
**確認人員**：Andy Hsu 
**理由**：音訊淡入被規劃在phase 3, 但這是必要的.
---

## 🟡 中優先度決策（建議決定）

### D2: 第一個單字影片的淡入行為

**問題描述**：  
批次模式中第一個單字影片是否應該從黑色淡入？如何與開頭影片 (entry.mp4) 協調？

**情境分析**：

#### 情境 A：有開頭影片 (entry.mp4)
```
[entry.mp4 直接播放] → [entry 停留] → [第一個單字影片]
                                        ↑ 是否需要淡入？
```

**選項 A1**：第一個單字影片淡入（推薦）✅
- **理由**：提供 entry → 主內容的過渡
- **視覺**：entry.mp4 → 短暂黑屏 → 單字影片淡入
- **一致性**：所有單字影片都從淡入開始（統一體驗）

**選項 A2**：第一個單字影片不淡入
- **理由**：entry.mp4 已提供開場，直接進入主內容
- **視覺**：entry.mp4 → 單字影片立即出現（硬切）
- **問題**：與後續單字影片行為不一致

#### 情境 B：無開頭影片
```
[第一個單字影片直接開始]
 ↑ 是否需要淡入？
```

**選項 B1**：從黑色淡入（推薦）✅
- **理由**：提供專業的開場效果
- **視覺**：黑屏 → 單字影片淡入
- **體驗**：避免突然出現，更柔和

**選項 B2**：直接開始（無淡入）
- **理由**：沒有前導內容，直接開始即可
- **問題**：可能顯得突兀

**決策建議**：
- ✅ 情境 A：有 entry.mp4 時，第一個單字影片應淡入
- ✅ 情境 B：無 entry.mp4 時，第一個單字影片從黑色淡入

**實作方式**：
```python
for idx, clip in enumerate(video_clips):
    # 所有影片都應用淡出
    clip = apply_fadeout(clip, 3.0)
    
    # 第一個影片根據是否有 entry 決定淡入
    if idx == 0:
        # 若有 entry.mp4，仍然淡入以提供過渡
        clip = clip.fadein(1.0)
    # 後續影片一律淡入
    elif idx > 0:
        clip = clip.fadein(1.0)
```

**需確認事項**：
- [ ] 產品負責人確認淡入行為符合預期
- [ ] 使用者測試驗證視覺流暢度

**決策結果**：採用選項 選項 A2（第一個單字影片不淡入）  
**確認人員**：Andy Hsu 
**理由**：開頭影片很短, 不適合套用一致的轉場效果
---

### D3: 淡出/淡入曲線類型

**問題描述**：  
規格建議使用「線性」淡出/淡入曲線，是否需要支援其他曲線類型？

**背景**：
- 線性曲線：`alpha(t) = t / duration`（視覺上均勻變化）
- 其他選項：指數曲線、S 曲線、ease-in/ease-out 等

**曲線比較**：

#### 線性曲線（規格建議）✅
```
亮度 100% |         ╱
          |       ╱
          |     ╱
          |   ╱
         0% | ╱
            └──────> 時間
```
**特性**：
- ✅ 簡單直觀
- ✅ MoviePy 預設行為
- ✅ 實作簡單
- ❌ 可能顯得「機械化」

#### 指數曲線（Exponential）
```
亮度 100% |       ╱╱
          |     ╱
          |   ╱
          | ╱
         0% |╱
            └──────> 時間
```
**特性**：
- ✅ 視覺更自然（模擬人眼感知）
- ❌ 實作稍複雜
- ❌ 需自訂 MoviePy effect

#### S 曲線（Ease-in-out）
```
亮度 100% |      ╱─
          |    ╱
          |  ╱
          | ╱
         0% |─
            └──────> 時間
```
**特性**：
- ✅ 專業影片常用
- ✅ 開始/結束更平滑
- ❌ 實作複雜
- ❌ 可能不符合教學影片風格

**決策建議**：**線性曲線**（Phase 1-2）+ 未來可選其他曲線（Phase 3）

**理由**：
- 線性曲線足夠專業且簡單
- 教學影片不需要過於複雜的效果
- 可在未來增加 `--fade-curve` 參數支援其他曲線

**需確認事項**：
- [ ] 產品負責人確認線性曲線的視覺效果
- [ ] 使用者測試是否反饋需要更「自然」的曲線

**決策結果**：採用線性曲線  
**確認人員**：Andy Hsu 
**理由**：目前先有基本轉場效果即可
---

### D8: 結尾影片 (ending.mp4) 的淡出處理

**問題描述**：  
當單字影片結束並接續結尾影片 (ending.mp4) 時，結尾影片本身是否需要淡出？

**流程示意**：
```
[單字影片 A] → 淡出 3s → [ending.mp4] → ?
```

**選項分析**：

#### 選項 1：結尾影片不額外淡出（推薦）✅
**理由**：
- ending.mp4 是整個輸出影片的最後片段，沒有後續內容
- 淡出到黑色後影片結束，使用者看到黑屏
- ending.mp4 本身可能已包含自己的結尾效果

**視覺流程**：
```
單字內容 → 淡出 3s → ending.mp4 正常播放 → 影片結束
```

**優點**：
- ✅ 符合直覺（沒有後續內容不需淡出）
- ✅ ending.mp4 完整呈現
- ✅ 避免多餘的黑屏

#### 選項 2：結尾影片也淡出
**理由**：
- 與單字影片一致（都有淡出）
- 提供「正式結束」的視覺提示

**視覺流程**：
```
單字內容 → 淡出 3s → ending.mp4 播放 → 淡出 3s → 黑屏 → 結束
```

**缺點**：
- ❌ 結尾影片內容被裁切（最後 3 秒淡出）
- ❌ 不必要的黑屏時間
- ❌ 若 ending.mp4 本身有結尾效果，會衝突

#### 選項 3：讓 ending.mp4 自行處理結尾
**理由**：
- ending.mp4 作為素材，應由製作者決定如何結束
- SpellVid 不額外添加效果

**建議**：
- ✅ 製作 ending.mp4 時，可在最後加入淡出或其他結尾效果
- ✅ SpellVid 僅負責連接，不修改 ending.mp4

**決策建議**：**選項 1** - 結尾影片不額外淡出

**實作方式**：
```python
# 主內容淡出
main_content = apply_fadeout(main_content, 3.0)

# 結尾影片不處理
ending_clip = VideoFileClip("assets/ending.mp4")

# 連接
final = concatenate_videoclips([main_content, ending_clip])
```

**需確認事項**：
- [ ] 產品負責人確認 ending.mp4 的處理方式
- [ ] 是否需要在文件中說明 ending.mp4 的製作建議？

**決策結果**：採用選項 1 (結尾影片不額外淡出)
**確認人員**：Andy Hsu 
**理由**：保留預設行為即可.

---

## 🟢 低優先度決策（可後續決定）

### D4: 音訊淡入功能需求

**問題描述**：  
目前規格定義下一影片音訊「立即恢復」，是否需要提供音訊淡入選項？

**背景**：
- 規格要求：畫面淡入 1 秒，音訊直接恢復
- 理由：節省時間、保持節奏

**使用情境**：
- **情境 1**：音樂開頭有強烈鼓點，立即恢復可能突兀
- **情境 2**：使用者偏好更柔和的音訊過渡

**選項分析**：

#### 選項 1：暫不實作音訊淡入（推薦）✅
**理由**：
- 當前需求明確：音訊直接恢復
- YAGNI 原則（You Aren't Gonna Need It）
- 可在使用者反饋後再實作

**實作影響**：無

#### 選項 2：提供 CLI 旗標（未來 Phase 3）
**設計**：
```powershell
# 預設：音訊直接恢復
python -m spellvid.cli batch --json config.json

# 啟用音訊淡入（與畫面同步 1 秒）
python -m spellvid.cli batch --json config.json --audio-fadein
```

**實作影響**：
- 需增加 CLI 參數
- 需修改音訊處理邏輯
- 需增加測試

**決策建議**：**選項 1** - 暫不實作，待使用者反饋

**需確認事項**：
- [ ] 產品負責人是否預期有此需求？
- [ ] 可否在初版發布後收集反饋再決定？

---

### D5: 自訂淡出/淡入時長的必要性

**問題描述**：  
是否需要在 Phase 1-2 就提供自訂淡出/淡入時長的 CLI 參數？

**背景**：
- 規格預設：淡出 3 秒、淡入 1 秒
- 部分使用者可能希望更快或更慢的過渡

**選項分析**：

#### 選項 1：Phase 1-2 使用固定值（推薦）✅
**理由**：
- 3 秒 / 1 秒是經過考慮的預設值
- 大多數使用者不需要自訂
- 可簡化初版實作

**實作**：
```python
FADE_OUT_DURATION = 3.0  # 固定值
FADE_IN_DURATION = 1.0   # 固定值
```

#### 選項 2：Phase 1-2 就提供自訂參數
**理由**：
- 向後相容 D7 選項 2（1 秒 → 3 秒過渡）
- 提供靈活性

**實作**：
```powershell
python -m spellvid.cli batch --json config.json \
  --fade-out-duration 2.0 \
  --fade-in-duration 0.5
```

**實作影響**：
- 增加 2 個 CLI 參數
- 需驗證參數範圍（0-10 秒）
- 需更新文件與測試

**決策建議**：**選項 1**（除非 D7 選擇選項 2）

**需確認事項**：
- [ ] D7 決策結果（向後相容策略）
- [ ] 是否有使用者明確要求自訂時長？

---

### D6: JSON 層級轉場設定的必要性

**問題描述**：  
是否需要支援在 JSON 中為每個單字項目設定不同的轉場效果？

**範例**：
```json
{
  "letters": "A",
  "word_en": "Apple",
  "word_zh": "蘋果",
  "transition": {
    "fade_out_duration": 2.0,
    "fade_in_duration": 0.5,
    "disable": false
  }
}
```

**選項分析**：

#### 選項 1：暫不支援（推薦）✅
**理由**：
- 增加設定複雜度
- 大多數情況不需要單字級別控制
- 可能導致視覺不一致

**缺點**：
- 無法處理特殊單字（如需要更長過渡）

#### 選項 2：未來擴充（Phase 3 或更晚）
**理由**：
- 保留擴充可能性
- 等待使用者反饋實際需求

**實作影響**：
- 需擴充 JSON Schema
- 需處理項目級別與全域設定的優先順序
- 需額外測試

**決策建議**：**選項 1** - 暫不支援

**需確認事項**：
- [ ] 是否有明確的使用情境需要單字級別控制？
- [ ] 可否透過分批渲染再手動合併來達成？

---

## 📊 決策矩陣總覽

### 建議決策路徑

**立即決策（開發前必須）**：
1. ✅ **D1 - 選項 1**：單一影片不淡出
2. ✅ **D7 - 選項 1**：直接升級為 3 秒（若使用者少）或 **選項 2**（若使用者多）
3. ✅ **D9 - 選項 1**：實作 Phase 1 + Phase 2（4-5 天）

**建議決策（開發初期確認）**：
4. ✅ **D2 - 推薦方案**：第一個單字影片淡入（統一體驗）
5. ✅ **D3 - 線性曲線**：使用線性淡出/淡入
6. ✅ **D8 - 選項 1**：結尾影片不額外淡出

**延後決策（Phase 3 或使用者反饋後）**：
7. ⏸️ **D4**：音訊淡入功能
8. ⏸️ **D5**：自訂時長參數
9. ⏸️ **D6**：JSON 層級設定

---

## 🎯 決策流程建議

### 階段 1：核心決策會議（1 小時）
**參與者**：產品負責人、技術負責人、QA 負責人

**議程**：
1. 決定 D1（單一影片淡出）→ 影響使用者體驗
2. 決定 D7（向後相容）→ 影響實作範圍
3. 決定 D9（實作階段）→ 確定時程

**輸出**：
- 決策記錄文件
- 更新規格狀態為 Approved

### 階段 2：技術細節確認（30 分鐘）
**參與者**：技術負責人、開發工程師

**議程**：
1. 確認 D2（第一個影片淡入）
2. 確認 D3（曲線類型）
3. 確認 D8（結尾影片處理）

**輸出**：
- 實作細節確認
- 開始開發

### 階段 3：迭代評估（發布後）
**時機**：Phase 1-2 發布後 2 週

**評估項目**：
- D4: 使用者是否反饋音訊直接恢復太突兀？
- D5: 使用者是否要求自訂時長？
- D6: 使用者是否需要單字級別控制？

**輸出**：
- Phase 3 功能規劃
- 規格更新

---

## 📋 正式決策記錄 (Decision Records)

### D1: 單一影片輸出模式的淡出行為

**決策編號**：D1  
**決策項目**：單一影片模式是否淡出  
**決策日期**：2025-01-08  
**決策者**：Andy Hsu  
**決策結果**：**選項 3** - 單一影片也淡出（一致性優先）  
**理由**：
- 保持所有輸出影片行為一致
- 實作簡單，無需區分批次/單一模式
- 使用者可預期所有影片都有相同的結尾效果

**影響範圍**：
- `spellvid/utils.py` - `render_video_stub()` 函式
- `spellvid/cli.py` - `make()` 和 `batch()` 使用相同的淡出邏輯
- 使用者文件 - 說明所有影片統一有 3 秒淡出

**後續行動**：
- [x] 所有影片統一應用淡出（無需模式檢查）
- [ ] 更新 README.md 說明淡出行為
- [ ] 增加單元測試驗證單一模式也淡出

---

### D2: 第一個單字影片的淡入行為

**決策編號**：D2  
**決策項目**：第一個單字影片淡入行為  
**決策日期**：2025-01-08  
**決策者**：Andy Hsu  
**決策結果**：**選項 A2** - 第一個單字影片不淡入  
**理由**：
- 開頭影片 (entry.mp4) 很短，不適合套用一致的轉場效果
- 第一個單字影片應直接開始，避免額外的黑色延遲
- 僅後續單字影片需要淡入（從前一影片淡出的黑色過渡）

**影響範圍**：
- 批次模式影片連接邏輯
- 開頭影片 (entry.mp4) 與主內容的過渡

**後續行動**：
- [x] 第一個影片不應用 `fadein()`
- [x] 第二個及後續影片應用 `fadein(1.0)`
- [ ] 測試 entry.mp4 → 第一個單字的直接過渡效果

---

### D3: 淡出/淡入曲線類型

**決策編號**：D3  
**決策項目**：淡出/淡入曲線類型  
**決策日期**：2025-01-08  
**決策者**：Andy Hsu  
**決策結果**：**線性曲線** (MoviePy 預設行為)  
**理由**：
- 簡單直觀，實作容易
- MoviePy 內建支援，效能可接受
- 教學影片不需要過於複雜的效果

**影響範圍**：
- 視覺效果品質
- 使用者觀感

**後續行動**：
- [x] 使用 MoviePy 預設的 `fadeout()` / `fadein()` 
- [ ] Phase 1-2 發布後收集使用者反饋
- [ ] 若有需求，Phase 3 增加 `--fade-curve` 參數

---

### D4: 音訊淡入功能需求

**決策編號**：D4  
**決策項目**：音訊淡入功能需求  
**決策日期**：2025-01-08  
**決策者**：Andy Hsu  
**決策結果**：**實作音訊淡入** - 音訊也應淡入（Phase 3 必要功能）  
**理由**：
- 音訊直接恢復可能過於突兀，尤其是有強烈鼓點的音樂
- 與畫面淡入同步，提供更柔和的聽覺過渡
- 雖規劃在 Phase 3，但被認為是必要功能

**影響範圍**：
- 音訊處理邏輯
- 使用者體驗（聽覺過渡）
- Phase 3 實作範圍

**後續行動**：
- [x] Phase 3 實作音訊淡入功能
- [ ] 下一影片音訊應用 `audio_fadein(duration=1.0)` 與畫面同步
- [ ] 可選：提供 `--no-audio-fadein` 讓使用者停用

---

### D5: 自訂淡出/淡入時長

**決策編號**：D5  
**決策項目**：自訂淡出/淡入時長的必要性  
**決策日期**：2025-01-08  
**決策者**：Andy Hsu  
**決策結果**：**Phase 3 實作自訂參數**  
**理由**：
- 3 秒淡出 / 1 秒淡入是經過考慮的預設值
- Phase 1-2 使用固定值簡化實作
- Phase 3 提供 CLI 參數讓使用者自訂時長

**影響範圍**：
- CLI 參數設計
- Phase 3 實作範圍

**後續行動**：
- [x] Phase 1-2 使用常數 `FADE_OUT_DURATION = 3.0` / `FADE_IN_DURATION = 1.0`
- [ ] Phase 3 增加 `--fade-out-duration` / `--fade-in-duration` 參數
- [ ] 保留擴充接口（函式參數支援自訂時長）

---

### D6: JSON 層級轉場設定

**決策編號**：D6  
**決策項目**：JSON 層級轉場設定的必要性  
**決策日期**：2025-01-08  
**決策者**：Andy Hsu  
**決策結果**：**暫不實作** - 不支援單字層級轉場設定  
**理由**：
- 增加設定複雜度，大多數情況不需要
- 可能導致視覺不一致
- 可透過分批渲染再手動合併達成特殊需求

**影響範圍**：
- JSON Schema 設計
- 使用者設定複雜度

**後續行動**：
- [x] JSON Schema 不增加 `transition` 欄位
- [ ] 文件說明全域統一轉場設定
- [ ] 保留未來擴充可能性

---

### D7: 向後相容策略（1 秒 vs 3 秒淡出）

**決策編號**：D7  
**決策項目**：向後相容策略  
**決策日期**：2025-01-08  
**決策者**：Andy Hsu  
**決策結果**：**選項 1** - 直接升級為 3 秒淡出（非破壞性變更）  
**理由**：
- 原本的 1 秒淡出尚未實作，可以忽略
- 沒有現有使用者依賴舊行為，無向後相容問題
- 直接實作 3 秒淡出，統一規格

**影響範圍**：
- ✅ **非破壞性變更** - 因為 1 秒淡出從未實作
- FR-EXPORT-3 規格更新（1s → 3s）
- 無需 CHANGELOG Breaking Change 標註

**後續行動**：
- [x] 更新 FR-EXPORT-3：淡出時長改為 3 秒
- [ ] 更新文件說明新行為
- [ ] 無需特殊溝通計畫（無現有使用者）

---

### D8: 結尾影片 (ending.mp4) 的淡出處理

**決策編號**：D8  
**決策項目**：結尾影片淡出處理  
**決策日期**：2025-01-08  
**決策者**：Andy Hsu  
**決策結果**：**選項 1** - 結尾影片不額外淡出  
**理由**：
- ending.mp4 是最終片段，沒有後續內容
- 避免不必要的黑屏時間
- 結尾影片製作者可自行決定如何結束

**影響範圍**：
- 批次模式影片連接邏輯
- ending.mp4 素材製作建議

**後續行動**：
- [x] 主內容淡出後直接連接 ending.mp4
- [x] ending.mp4 本身不應用 `fadeout()`
- [ ] 文件說明 ending.mp4 製作建議（可自行包含結尾效果）

---

### D9: 實作優先順序與時程

**決策編號**：D9  
**決策項目**：實作優先順序  
**決策日期**：2025-01-08  
**決策者**：Andy Hsu  
**決策結果**：**選項 2** - 完整實作 Phase 1-3  
**理由**：
- 音訊淡入被規劃在 Phase 3，但這是必要的功能（D4 決策）
- 自訂時長參數對使用者有實際價值（D5 決策）
- 一次性完成所有功能，避免後續迭代

**實作範圍**：
- ✅ Phase 1 (2-3 天):
  - 淡出效果（畫面 + 音訊，固定 3 秒）
  - 淡入效果（畫面，固定 1 秒）
  - 基本單元測試
- ✅ Phase 2 (2 天):
  - 批次模式整合
  - 整合測試 + E2E 測試
  - 文件更新（requirement.md, TDD.md）
- ✅ Phase 3 (2-3 天):
  - **音訊淡入功能**（必要，與畫面同步 1 秒）
  - CLI 自訂時長參數 (`--fade-out-duration`, `--fade-in-duration`)
  - 可選：`--no-audio-fadein` 旗標

**時程**：總計 6-8 工作天

**後續行動**：
- [ ] 建立 GitHub Issue: "實作影片轉場效果 (Phase 1+2+3)"
- [ ] 分配開發資源
- [ ] 設定里程碑與交付日期
- [ ] 完整實作所有三個階段

---

## 📝 決策記錄模板

**決策編號**：Dxx  
**決策項目**：[項目名稱]  
**決策日期**：YYYY-MM-DD  
**決策者**：[姓名 + 角色]  
**決策結果**：選項 x  
**理由**：[簡述 1-2 行]  
**影響範圍**：[列出受影響的模組/文件]  
**後續行動**：[Action items]

---

## ✅ 決策追蹤檢查清單

完成決策後，請確認以下事項：

- [x] 所有高優先度決策（D1, D7, D9）已完成
- [x] 決策結果已記錄於本文件
- [ ] 相關規格文件已更新（video-transition-effects.md）
- [ ] 需求文件已更新（doc/requirement.md）
- [ ] 測試計畫已更新（doc/TDD.md）
- [ ] 實作團隊已被告知決策結果
- [ ] 開發時程已根據決策調整

---

## 📞 聯絡資訊

**有疑問或需要討論？**
- 產品負責人：[TBD]
- 技術負責人：[TBD]
- 本規格維護者：[TBD]

---

**文件版本歷史**

| 版本 | 日期 | 變更內容 | 作者 |
|------|------|----------|------|
| v0.1 | 2025-01-08 | 初版建立 | GitHub Copilot |
| v1.0 | 2025-01-08 | 完成所有決策，狀態更新為 Approved | 產品負責人 + 技術負責人 |

---

**✅ 決策已完成！**

**下一步行動**：

**立即行動（已完成）**：
- ✅ 所有決策已記錄於本文件
- ✅ 決策摘要表已更新

**待執行行動**：
1. 📝 **更新相關規格文件**：
   - [ ] 更新 `.specify/video-transition-effects.md`（將狀態改為 Approved）
   - [ ] 更新 `doc/requirement.md`（FR-EXPORT-3: 1s → 3s，新增 FR-EXPORT-6）
   - [ ] 更新 `doc/TDD.md`（新增 TCS-TRANSITION-001 ~ 006）

2. 🔨 **開始實作**：
   - [ ] 建立 GitHub Issue: "實作影片轉場效果 (Phase 1+2)"
   - [ ] 分配開發者與時程（4-5 工作天）
   - [ ] 設定里程碑與交付日期

3. 📢 **溝通與文件**：
   - [ ] 準備 CHANGELOG（標註 Breaking Change）
   - [ ] 更新 README.md 使用範例
   - [ ] 通知團隊成員決策結果

**預計時程**：
- 文件更新：0.5 天
- Phase 1 開發：2-3 天
- Phase 2 測試：2 天
- 總計：4.5-5.5 天

**建議開始日期**：決策批准後立即開始
